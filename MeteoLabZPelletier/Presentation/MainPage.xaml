<Page x:Class="MeteoLabZPelletier.Presentation.MainPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:local="using:MeteoLabZPelletier.Presentation"
      xmlns:models="using:MeteoLabZPelletier.Models"
      xmlns:uen="using:Uno.Extensions.Navigation.UI"
      xmlns:utu="using:Uno.Toolkit.UI"
      xmlns:um="using:Uno.Material"
      xmlns:lc="using:LiveChartsCore.SkiaSharpView.WinUI"
      NavigationCacheMode="Required"
      Background="{ThemeResource BackgroundBrush}">
    <Grid x:Name="rootGrid">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel x:Name="Header" Grid.Row="0" Background="AliceBlue">
            <TextBlock x:Name="Title" 
                   Foreground="Black" 
                   FontSize="48" 
                   FontFamily="Sangrita" 
                   Text="MeteoLab" 
                   HorizontalAlignment="Center" 
                   VerticalAlignment="Center" 
                   Margin="0,20,0,20"/>
        </StackPanel>

        <!-- Pivot Control -->
        <Pivot Grid.Row="1" x:Name="MainPivot">

            <!-- Menu Principal Tab -->
            <PivotItem Header="Menu Principal">
                <Grid Background="Blue">
                    <Grid x:Name="QuickInfoBlock">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Orientation="Horizontal"
                                Grid.Column="0"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center">
                            <TextBlock x:Name="DateText"
                                   Margin="0,0,10,0"
                                   Text="{x:Bind ViewModel.DateCourante}"
                                   Foreground="White"
                                   FontSize="20"/>
                            <TextBlock x:Name="TempText"
                                   Text="{x:Bind ViewModel.TemperatureCourante}"
                                   Foreground="White"
                                   FontSize="20"/>
                        </StackPanel>

                        <StackPanel Orientation="Vertical"
                                Grid.Column="1"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center">
                            <TextBlock Text="Bienvenue à MeteoLab"
                                   Foreground="White"
                                   FontSize="24"
                                   HorizontalAlignment="Center"
                                   Margin="0,0,0,30"/>
                            <TextBlock Text="Utilisez les onglets ci-dessus pour naviguer"
                                   Foreground="White"
                                   FontSize="16"
                                   HorizontalAlignment="Center"/>
                        </StackPanel>
                    </Grid>
                </Grid>
            </PivotItem>

            <!-- Entrée de Données Tab -->
            <PivotItem Header="Entrée de Données">
                <Grid>
                    <ContentDialog x:Name="ReplaceDataDialog"
                        Title="Date existante"
                        PrimaryButtonText="Remplacer"
                        CloseButtonText="Annuler"
                        DefaultButton="Close">
                        <StackPanel Spacing="10">
                            <TextBlock TextWrapping="Wrap">
                            </TextBlock>
                            <TextBlock Text="Une entrée existe déjà pour la date "></TextBlock>
                            <TextBlock x:Name="ExistingDateText" Text="{x:Bind DateExistante,Mode=OneWay}" FontWeight="Bold"></TextBlock>
                            <TextBlock Text=". Voulez-vous la remplacer?"></TextBlock>
                        </StackPanel>
                    </ContentDialog>

                    <Grid Background="Blue">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Orientation="Vertical"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Spacing="20"
                            Grid.Column="0">

                            <StackPanel Orientation="Horizontal" Spacing="10">
                                <TextBlock Text="Date (dd/MM/YYYY):" 
                                   VerticalAlignment="Center"
                                   Foreground="White"
                                   Width="180"/>
                                <TextBox x:Name="DateBox" Width="200"/>
                            </StackPanel>

                            <StackPanel Orientation="Horizontal" Spacing="10">
                                <TextBlock Text="Temperature (C):" 
                                   VerticalAlignment="Center"
                                   Foreground="White"
                                   Width="180"/>
                                <TextBox x:Name="TempBox" Width="200"/>
                            </StackPanel>

                            <StackPanel Orientation="Horizontal" Spacing="10">
                                <TextBlock Text="Précipitations (mm):" 
                                   VerticalAlignment="Center"
                                   Foreground="White"
                                   Width="180"/>
                                <TextBox x:Name="PrecipBox" Width="200"/>
                            </StackPanel>
                            
                            <StackPanel Orientation="Horizontal" Spacing="10">
                                <TextBlock Text="Humidité (%):" 
                                   VerticalAlignment="Center"
                                   Foreground="White"
                                   Width="180"/>
                                <TextBox x:Name="HumidBox" Width="200"/>
                            </StackPanel>

                            <StackPanel Orientation="Horizontal">
                                <Button Content="Ajouter les données"
                            Click="AjouterBouton"
                              HorizontalAlignment="Center"
                              Margin="0,20,0,0"
                              BorderBrush="DarkSlateGray"
                              BorderThickness="3"
                              Width="200"
                              Height="50"/>

                                <Button Content="Importer CSV" 
                              Click="ImporterCSV"
                              HorizontalAlignment="Center"
                              Margin="0,20,0,0"
                              BorderBrush="DarkSlateGray"
                              BorderThickness="3"
                              Width="200"
                              Height="50"/>
                            </StackPanel>

                        </StackPanel>

                        <ListView
                                Grid.Column="1"
                                ItemsSource="{x:Bind ViewModel.ListePrincipale, Mode=OneWay}">
                            <ListView.ItemTemplate>
                                <DataTemplate x:DataType="models:Donnees">
                                    <StackPanel Orientation="Horizontal" 
                                        Padding="10" 
                                        Spacing="15">
                                        <TextBlock Text="{x:Bind Date}" 
                                            Foreground="White" 
                                            Width="120"
                                            FontSize="16"/>
                                        <TextBlock Text="{x:Bind Temperature}" 
                                            Foreground="White" 
                                            Width="20"
                                            FontSize="16"/>
                                        <TextBlock Text="°C" 
                                            Foreground="White" 
                                            Width="30"
                                            FontSize="16"/>
                                        <TextBlock Text="{x:Bind Precipitations}" 
                                            Foreground="White" 
                                            Width="20"
                                            FontSize="16"/>
                                        <TextBlock Text="mm" 
                                            Foreground="White" 
                                            FontSize="16"/>
                                        <TextBlock Text="{x:Bind Humidite}" 
                                            Foreground="White" 
                                            Width="20"
                                            FontSize="16"/>
                                        <TextBlock Text="%" 
                                            Foreground="White" 
                                            FontSize="16"/>
                                    </StackPanel>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                    </Grid>
                </Grid>
            </PivotItem>

            <!-- Calcul des Statistiques Tab -->
            <PivotItem Header="Calcul des Statistiques">
                <Grid Background="Blue">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="1*"/>
                        <ColumnDefinition Width="1*"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Orientation="Vertical"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Spacing="20"
                            Grid.Column="0">

                        <StackPanel Orientation="Vertical" Spacing="15">
                            <StackPanel Orientation="Horizontal" Spacing="10">
                                <TextBlock Text="Date de début:" 
                                    VerticalAlignment="Center"
                                    Foreground="White"
                                    Width="180"/>
                                <CalendarDatePicker x:Name="DateDebutPicker" 
                                    Width="200"
                                    PlaceholderText="Sélectionner date"
                                    Date="{x:Bind ViewModel.DateDebutPicker, Mode=TwoWay}" />
                            </StackPanel>

                            <StackPanel Orientation="Horizontal" Spacing="10">
                                <TextBlock Text="Date de fin:" 
                                    VerticalAlignment="Center"
                                    Foreground="White"
                                    Width="180"/>
                                <CalendarDatePicker x:Name="DateFinPicker" 
                                    Width="200"
                                    PlaceholderText="Sélectionner date"
                                    Date="{x:Bind ViewModel.DateFinPicker, Mode=TwoWay}" />
                            </StackPanel>
                        </StackPanel>


                        <Button Content="Calculer les statistiques"
                            Click="CalculerStatsClick"
                              HorizontalAlignment="Center"
                              Margin="0,20,0,0"
                              BorderBrush="DarkSlateGray"
                              BorderThickness="3"
                              FontSize="12"
                              Width="200"
                              Height="50"/>

                    </StackPanel>

                    <Grid Grid.Column="1">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- Statistics Pivot -->
                        <Pivot Grid.Row="0" x:Name="StatistiquesPivot"
                               MaxWidth="550">

                            <!-- Moyenne Tab -->
                            <PivotItem Header="Moyenne">
                                <Grid Background="Blue">
                                    <StackPanel Orientation="Horizontal"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Spacing="50">

                                        <StackPanel Orientation="Vertical" Spacing="5">
                                            <TextBlock Text="Température Moyenne"
                                   Foreground="White"
                                   FontSize="14"
                                   HorizontalAlignment="Center"/>
                                            <TextBlock x:Name="MoyenneTempText"
                                   Text="{x:Bind ViewModel.AvgTemp, Mode=OneWay}"
                                   Foreground="White"
                                   FontSize="18"
                                   FontWeight="Bold"
                                   HorizontalAlignment="Center"/>
                                        </StackPanel>

                                        <StackPanel Orientation="Vertical" Spacing="5">
                                            <TextBlock Text="Précipitations Moyennes"
                                   Foreground="White"
                                   FontSize="14"
                                   HorizontalAlignment="Center"/>
                                            <TextBlock x:Name="MoyennePrecipText"
                                   Text="{x:Bind ViewModel.AvgPrecip, Mode=OneWay}"
                                   Foreground="White"
                                   FontSize="18"
                                   FontWeight="Bold"
                                   HorizontalAlignment="Center"/>
                                        </StackPanel>

                                        <StackPanel Orientation="Vertical" Spacing="5">
                                            <TextBlock Text="Humidité Moyenne"
                                   Foreground="White"
                                   FontSize="14"
                                   HorizontalAlignment="Center"/>
                                            <TextBlock x:Name="MoyenneHumidText"
                                   Text="{x:Bind ViewModel.AvgHumid, Mode=OneWay}"
                                   Foreground="White"
                                   FontSize="18"
                                   FontWeight="Bold"
                                   HorizontalAlignment="Center"/>
                                        </StackPanel>

                                    </StackPanel>
                                </Grid>
                            </PivotItem>

                            <!-- Minimum Tab -->
                            <PivotItem Header="Minimum">
                                <Grid Background="Blue">
                                    <StackPanel Orientation="Horizontal"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Spacing="50">

                                        <StackPanel Orientation="Vertical" Spacing="5">
                                            <TextBlock Text="Température Minimale"
                                   Foreground="White"
                                   FontSize="14"
                                   HorizontalAlignment="Center"/>
                                            <TextBlock x:Name="MinTempText"
                                   Text="{x:Bind ViewModel.MinTemp, Mode=OneWay}"
                                   Foreground="White"
                                   FontSize="18"
                                   FontWeight="Bold"
                                   HorizontalAlignment="Center"/>
                                        </StackPanel>

                                        <StackPanel Orientation="Vertical" Spacing="5">
                                            <TextBlock Text="Précipitations Minimales"
                                   Foreground="White"
                                   FontSize="14"
                                   HorizontalAlignment="Center"/>
                                            <TextBlock x:Name="MinPrecipText"
                                   Text="{x:Bind ViewModel.MinPrecip, Mode=OneWay}"
                                   Foreground="White"
                                   FontSize="18"
                                   FontWeight="Bold"
                                   HorizontalAlignment="Center"/>
                                        </StackPanel>

                                        <StackPanel Orientation="Vertical" Spacing="5">
                                            <TextBlock Text="Humidité Minimale"
                                   Foreground="White"
                                   FontSize="14"
                                   HorizontalAlignment="Center"/>
                                            <TextBlock x:Name="MinHumidText"
                                   Text="{x:Bind ViewModel.MinHumid, Mode=OneWay}"
                                   Foreground="White"
                                   FontSize="18"
                                   FontWeight="Bold"
                                   HorizontalAlignment="Center"/>
                                        </StackPanel>

                                    </StackPanel>
                                </Grid>
                            </PivotItem>

                            <!-- Maximum Tab -->
                            <PivotItem Header="Maximum">
                                <Grid Background="Blue">
                                    <StackPanel Orientation="Horizontal"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Spacing="50">

                                        <StackPanel Orientation="Vertical" Spacing="5">
                                            <TextBlock Text="Température Maximale"
                                   Foreground="White"
                                   FontSize="14"
                                   HorizontalAlignment="Center"/>
                                            <TextBlock x:Name="MaxTempText"
                                   Text="{x:Bind ViewModel.MaxTemp, Mode=OneWay}"
                                   Foreground="White"
                                   FontSize="18"
                                   FontWeight="Bold"
                                   HorizontalAlignment="Center"/>
                                        </StackPanel>

                                        <StackPanel Orientation="Vertical" Spacing="5">
                                            <TextBlock Text="Précipitations Maximales"
                                   Foreground="White"
                                   FontSize="14"
                                   HorizontalAlignment="Center"/>
                                            <TextBlock x:Name="MaxPrecipText"
                                   Text="{x:Bind ViewModel.MaxPrecip, Mode=OneWay}"
                                   Foreground="White"
                                   FontSize="18"
                                   FontWeight="Bold"
                                   HorizontalAlignment="Center"/>
                                        </StackPanel>

                                        <StackPanel Orientation="Vertical" Spacing="5">
                                            <TextBlock Text="Humidité Maximale"
                                   Foreground="White"
                                   FontSize="14"
                                   HorizontalAlignment="Center"/>
                                            <TextBlock x:Name="MaxHumidText"
                                   Text="{x:Bind ViewModel.MaxHumid, Mode=OneWay}"
                                   Foreground="White"
                                   FontSize="18"
                                   FontWeight="Bold"
                                   HorizontalAlignment="Center"/>
                                        </StackPanel>

                                    </StackPanel>
                                </Grid>
                            </PivotItem>

                            <!-- Écart-type Tab -->
                            <PivotItem Header="Écart-type">
                                <Grid Background="Blue">
                                    <StackPanel Orientation="Horizontal"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Spacing="50">

                                        <StackPanel Orientation="Vertical" Spacing="5">
                                            <TextBlock Text="Écart-type Température"
                                   Foreground="White"
                                   FontSize="14"
                                   HorizontalAlignment="Center"/>
                                            <TextBlock x:Name="EcartTypeTempText"
                                   Text="{x:Bind ViewModel.EtTemp, Mode=OneWay}"
                                   Foreground="White"
                                   FontSize="18"
                                   FontWeight="Bold"
                                   HorizontalAlignment="Center"/>
                                        </StackPanel>

                                        <StackPanel Orientation="Vertical" Spacing="5">
                                            <TextBlock Text="Écart-type Précipitations"
                                   Foreground="White"
                                   FontSize="14"
                                   HorizontalAlignment="Center"/>
                                            <TextBlock x:Name="EcartTypePrecipText"
                                   Text="{x:Bind ViewModel.EtPrecip, Mode=OneWay}"
                                   Foreground="White"
                                   FontSize="18"
                                   FontWeight="Bold"
                                   HorizontalAlignment="Center"/>
                                        </StackPanel>

                                        <StackPanel Orientation="Vertical" Spacing="5">
                                            <TextBlock Text="Écart-type Humidité"
                                   Foreground="White"
                                   FontSize="14"
                                   HorizontalAlignment="Center"/>
                                            <TextBlock x:Name="EcartTypeHumidText"
                                   Text="{x:Bind ViewModel.EtHumid, Mode=OneWay}"
                                   Foreground="White"
                                   FontSize="18"
                                   FontWeight="Bold"
                                   HorizontalAlignment="Center"/>
                                        </StackPanel>

                                    </StackPanel>
                                </Grid>
                            </PivotItem>

                        </Pivot>

                        <Grid Grid.Row="1" Background="LightBlue">
                            <lc:CartesianChart 
                                Series="{x:Bind ViewModel.TemperatureSeries, Mode=OneWay}"
                                XAxes="{x:Bind ViewModel.XAxis, Mode=OneWay}"
                                YAxes="{x:Bind ViewModel.YAxis, Mode=OneWay}"/>
                        </Grid>
                    </Grid>

                </Grid>
            </PivotItem>

        </Pivot>
    </Grid>
</Page>
